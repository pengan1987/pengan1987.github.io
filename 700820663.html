<html><head><title>在中国接入互联网30周年之时，搭一台1994年的Linux服务器（中）</title></head><body><h1>在中国接入互联网30周年之时，搭一台1994年的Linux服务器（中）</h1><p>作者：蓬岸 Dr.Quest<br>知乎文章编号：700820663<br>创建于：2024-06-02 10:30:58<br>修改于：2024-06-02 10:30:58</p><hr><p data-pid="Cy091of8">在网络创业资源中心（NSRC）提供的连接提供者数据库（Connectivity Provider Database）中，保留了<a href="https://nsrc.org/db/lookup/report.php?id=890202394613:497426773&fromISO=CN" class=" wrap external" target="_blank" rel="nofollow noreferrer">1994年6月1日的《中国互联网技术论坛简报》（CINET-L）</a>，其中中科院高能所吴玲老师撰写的《IHEP 网络发展回顾与展望 - 引言》（Review and Prospect of IHEP Network Development - An lntroduction）一文中介绍了中国互联网开通时所提供的网络服务：</p><blockquote data-pid="WJvDDhKY">In May, 1994, IHEP finally gained full access to the Internet, so that IHEP users can transfer files and connect to any of the Internet nodes instead of just sending E-mail messages, and all the outside users can ftp and telnet to IHEP directly from their internet machines.<br/><br/>Our permanent Internet email address is now<br/><a href="mailto:user@machine.ihep.ac.cn">user@machine.ihep.ac.cn</a>:<br/><br/>IHEP Computing Center has set up WWW and Gopher server.<br/><br/>1994 年 5 月，IHEP 终于全面接入互联网，这样，IHEP 用户就可以传输文件并连接到互联网的任何节点，而不仅仅是发送电子邮件，所有外部用户都可以直接从他们的互联网机器上通过 ftp 和 telnet 连接到 IHEP。<br/><br/>我们永久性的互联网电子邮件地址现在是<br/><a href="mailto:user@machine.ihep.ac.cn">user@machine.ihep.ac.cn</a><br/><br/>IHEP 计算中心建立了 WWW 和 Gopher 服务器。</blockquote><p data-pid="3-tEBJMu">那我们就把WWW和Gopher服务器架设起来吧！</p><h2>WWW服务器：CERN还是NCSA？</h2><p data-pid="Kuw2Nt5u">我们首先要回答的问题是，1994年高能所最有可能使用的Web server是那一款？后来成为Linux标准Web技术栈的LAMP中的Apache要到1995年才发布。在《<a href="http://mp.ihep.ac.cn/article/pdf/preview/8501" class=" wrap external" target="_blank" rel="nofollow noreferrer">中国第一个WWW网站诞生记</a>》中，高能所许榕生老师回忆了他1994年4月在WWW的诞生地CERN接触Web技术并将其带回国内的经历，我们不难推测高能所很有可能使用的是CERN开发的CERN HTTPd（早期版本叫做WWW Daemon）。</p><p data-pid="FH--g41F">但很快这个推断就被动摇了，因为佐治亚理工学院在1994年就曾经做过<a href="https://sites.cc.gatech.edu/gvu/user_surveys/papers/survey_1_paper.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">《第一次万维网用户调查》（First World-Wide Web User Survey）</a>，其中的数据显示当时最流行的Web服务器是NCSA HTTPd，占比71.88%，第二名是Plexus，一款由Perl编写的Web服务器，占12.73%；而CERN HTTPd仅和<a href="https://man.freebsd.org/cgi/man.cgi?query=gn&manpath=Red+Hat+4.2" class=" wrap external" target="_blank" rel="nofollow noreferrer">GN</a>，一款同时支持Gopher和WWW的服务器软件分享7.43%的使用量：</p><div class="highlight"><pre><code class="language-text">Table 4: Results from the HTTP Survey 
---------------------------------------------------------------------
Question 1.                   Yes         No                    Total  
Operate HTTP Server / %       378 /       103 /                 481    
                              78.59       21.41                        
Question 2.                   GN or Cern  NSCA   Plexus  Other  Total  
If Yes, Which Server / %      28 /        271 /  48 /    30 /   377    
                              7.43        71.88  12.73   7.96          </code></pre></div><p data-pid="0FOIdVj7">因此从当时软件的流行趋势来讲，来自美国国家超级计算应用中心（NCSA）的NCSA HTTPd同样可能被运用在高能所的服务器上。</p><p data-pid="9zm3yuBr">但还有没有其他证据呢？在Github上的一份《Chinese-HOWTO》文件上，我找到了高能所曾经使用过的另一个域名，<a href="http://csun01.ihep.ac.cn" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">csun01.ihep.ac.cn</span><span class="invisible"></span></a>，而这个域名下曾经分享了当时的一些WWW软件，其中CERN目录虽然我没法查看，但很可能是CERN HTTPd相关的文件。</p><p data-pid="6ty-f02o"><a href="https://github.com/kalamangga-net/Linux-HOWTOs/blob/master/Chinese-HOWTO" class=" wrap external" target="_blank" rel="nofollow noreferrer">Linux-HOWTOs/Chinese-HOWTO at master · kalamangga-net/Linux-HOWTOs</a></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-b8af829962088abe904cde471f446197_b.jpg" data-caption="" data-size="normal" data-rawwidth="624" data-rawheight="397" class="origin_image zh-lightbox-thumb" width="624" data-original="https://pic4.zhimg.com/v2-b8af829962088abe904cde471f446197_r.jpg" data-original-token="v2-b8af829962088abe904cde471f446197"/></figure><p data-pid="YLEUxrMD">我最终还是做出了这个艰难的决定：<b>两个都要！</b></p><p data-pid="otx3T-UE"><b>从回溯万维网历史的角度讲，CERN和NCSA的HTTPd几乎同样重要</b>：CERN HTTPd延续自Tim Berners-Lee亲自编写的WWW Daemon，是第一个万维网服务器软件，而NCSA HTTPd则是Apache的直接前身，并占据万维网服务器市场份额第一的宝座超过20年时间。</p><h2>编译并运行CERN HTTPd</h2><p data-pid="Pc-lNnjq">由于在这个系列的上一集我们已经安装好SoftLanding Linux System（SLS）并连接上TCP/IP网络，所以这一集我们大多数的操作通过Telnet进行，你可以选用自己习惯的终端仿真软件，我的参考配置是Windows 10上的Putty。</p><a href="https://zhuanlan.zhihu.com/p/700400046" data-draft-node="block" data-draft-type="link-card" data-image="https://pic1.zhimg.com/v2-11799ca220068b3a78e96ccd0b6e9c1c_qhd.jpg" data-image-width="720" data-image-height="400" class="internal">蓬岸 Dr.Quest：在中国接入互联网30周年之时，搭一台1994年的Linux服务器（上）</a><h3>为SLS安装Linux内核源码</h3><p data-pid="8_l6symz">编译CERN HTTPd之前，我们先要为它安装Linux内核源码，不然就会因为无法引入某些Linux头文件而失败。</p><p data-pid="qkH_Je69">在SLS的默认安装中，/usr/include/linux是一个指向/usr/src/linux/include/linux/的软链接</p><div class="highlight"><pre><code class="language-text">p:softland:/usr/include$ ls -l linux
lrwxrwxrwx   1 root     root           26 May 30  1924 linux -&gt; ../src/linux/include/linux/</code></pre></div><p data-pid="pcicfLcq">而如果没有安装Linux源码，/usr/src/linux目录也就不会出现，因此就会编译出错。而解决的办法，就是手工安装SLS安装盘中所提供的Linux内核源码。</p><p data-pid="Ear_7LOa">SLS安装盘中，编号为“s1”的软盘中包含的“lxsrc.tgz”就是Linux内核源代码包，而SLS提供一个没有依赖检查的包安装命令“sysinstall”，我们可以用它将lxsrc.tgz安装到系统中，而不用担心目录结构的问题。</p><div class="highlight"><pre><code class="language-bash"><span class="c1">#挂载第二块硬盘（安装文件所在位置，见上集）到/mnt</span>
mount -t msdos /dev/hdb1 /mnt
<span class="c1">#进入安装盘s1目录</span>
<span class="nb">cd</span> /mnt/install/s1/
<span class="c1">#安装内核源码包</span>
sysinstall -install lxsrc.tgz</code></pre></div><h3>编译CERN HTTPd</h3><p data-pid="aXLZqstf">在W3C网站上，保留了许多旧版本CERN HTTPd的源码：<a href="https://www.w3.org/Daemon/old/Dist/" class=" wrap external" target="_blank" rel="nofollow noreferrer">Index of /Daemon/old/Dist</a>，我自己使用下来，决定用1994年3月的CERN HTTPd 2.16做演示，在这个版本中，和CERN HTTPd一同编译的还有著名的WWW Line Mode Browser，而在2.17之后的版本中，则需要手工在WWW/All/Implementation/Makefile中取恢复被注释掉的LineMode Browser部分才可以使用LineMode Browser。</p><p data-pid="dTgNkRXQ">我们使用FTP上传，或是利用上一集中提到的DOS格式的第二块硬盘做中转站，将cern_httpd_2.16beta.tar.Z复制到SLS系统中，我自己一般使用/root目录，利用tar zxvf命令解压，就会得到WWW目录，内容如下：</p><div class="highlight"><pre><code class="language-text">All/           Copyright.txt  Library/       Makefile
BUILD*         Daemon/        LineMode/      README.txt</code></pre></div><p data-pid="-EdKfdjb">其中的BUILD脚本就是CERN HTTPd的编译脚本了，但如果我们直接运行它，会提示找不到文件，原因是该脚本是csh脚本，而SLS提供的是与之兼容的tcsh，我们需要建立一个软链接，让/bin/csh调用tcsh。此外，BUILD脚本由于不能识别Linux系统，需要单独设置WWW_MACH为“unix”</p><div class="highlight"><pre><code class="language-bash"><span class="c1">#链接csh命令</span>
ln -s /bin/tcsh /bin/csh
<span class="c1">#设置环境变量</span>
<span class="nb">export</span> <span class="nv">WWW_MACH</span><span class="o">=</span>unix</code></pre></div><p data-pid="8M5AM-Yn">之后BUILD脚本就可以正常编译了，之后我们进入WWW/Daemon/unix，就会看到下面这些文件</p><div class="highlight"><pre><code class="language-text">cgiparse -&gt; cgiparse_2.16beta*
cgiparse_2.16beta*
htadm -&gt; htadm_2.16beta*
htadm_2.16beta*
htimage -&gt; htimage_2.16beta*
htimage_2.16beta*
httpd -&gt; httpd_2.16beta*
httpd_2.16beta*</code></pre></div><p data-pid="dWyAxDM9">其中httpd就是HTTP服务器的主文件了，我们先用命令行启动一个简单的HTTPd</p><div class="highlight"><pre><code class="language-bash">httpd -v -dy /root/ -p <span class="m">80</span></code></pre></div><p data-pid="yOlQJOkd">命令中v参数是啰嗦（verbose）模式，我们能看到更详细的信息，而“dy”则是允许访问目录结构，“p”参数则指定端口，详细的命令行参数，可以在<a href="https://www.w3.org/Daemon/old/UserGuide_2.16/Guide.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">CERN Server User Guide</a> 中的 Administration → Command line options。在当代浏览器中输入 http://&lt;SLS的IP地址&gt;，就可以查看到/root目录中的内容。</p><h3>首页和配置文件</h3><p data-pid="12CTtmTj">我们可以参照CERN手册中的例子创建一个最简单的配置文件 <a href="https://www.w3.org/Daemon/old/UserGuide_2.16/RuleExamples.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">Examples of CERN httpd configuration (rule) files</a></p><div class="highlight"><pre><code class="language-text">Pass    /          file:/root/myhttphome/welcome.html
Pass    /*         file:/root/myhttphome/*
Fail    *</code></pre></div><p data-pid="Qwp0OaqB">在这个例子里，我们把首页设置为/root/myhttphome/welcome.html，并允许访问/root/myhttphome/下的其他文件。我们在welcome.html里可以随意编写一些内容，当时的HTML格式比较松散，&lt;html&gt;文件头都不是必要的</p><div class="highlight"><pre><code class="language-html"><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>This is my first page<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Welcome to the CERN HTTPd on SLS<span class="p">&lt;/</span><span class="nt">H1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>This is a real 1994 style web server!<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span></code></pre></div><p data-pid="h6lgBkmk">接下来我们用“-r”参数启动CERN HTTPd，并调用配置文件</p><div class="highlight"><pre><code class="language-bash">httpd -r httpd.conf -v -p <span class="m">80</span></code></pre></div><p data-pid="etJ0U3jz">然后就它就可以以今天的HTTP服务器类似的方式提供网页了</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-0dc024dca1332f728e4ce809d4e3a45e_b.jpg" data-caption="" data-size="normal" data-rawwidth="761" data-rawheight="258" class="origin_image zh-lightbox-thumb" width="761" data-original="https://pic3.zhimg.com/v2-0dc024dca1332f728e4ce809d4e3a45e_r.jpg" data-original-token="v2-0dc024dca1332f728e4ce809d4e3a45e"/></figure><h3>体验Line Mode Browser</h3><p data-pid="DZCmPzdW">在万维网发明之初，图形化的浏览器只在NeXTSTEP平台上可用，而第一个跨平台并被广泛使用的浏览器，是Line Mode Browser“行模式浏览器”，顾名思义，它是供逐行显示字符的文本终端准备的。2013年，CERN的团队在网页里还原了Line Mode Browser的部分体验：<a href="https://line-mode.cern.ch/" class=" wrap external" target="_blank" rel="nofollow noreferrer">Line Mode Browser 2013</a>。而现在，我们有一个真正的Line Mode Browser，如果你也有一台哑终端，那就再好不过了！</p><a href="https://www.bilibili.com/video/BV1hK4y1t7qb/" data-draft-node="block" data-draft-type="link-card" data-image="https://pic4.zhimg.com/v2-b5780abd9d10c23bdeb86d80f5ae3b2b_l.jpg" data-image-width="100" data-image-height="100" class=" wrap external" target="_blank" rel="nofollow noreferrer">[哑终端]实达中英文网络终端NT1100连接树莓派_哔哩哔哩_bilibili</a><p data-pid="ucbMYWsv">编译好的Line Mode Browser在WWW/LineMode/unix目录里，我们可以把它的可执行文件和软链接都复制到usr/bin/里，这样不用超级用户权限也可以使用它了</p><div class="highlight"><pre><code class="language-bash"><span class="nb">cd</span> /root/WWW/LineMode/unix
cp www_2.12 /usr/bin/
cp www /usr/bin/</code></pre></div><p data-pid="NqjsBfG6">然后我们可以试着访问以下本机上的HTTPd，使用 www <span class="nolink">http://127.0.0.1</span> 命令即可</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-c131807e7fe55be721953ee04902f1b8_b.jpg" data-caption="" data-size="normal" data-rawwidth="885" data-rawheight="821" class="origin_image zh-lightbox-thumb" width="885" data-original="https://pic1.zhimg.com/v2-c131807e7fe55be721953ee04902f1b8_r.jpg" data-original-token="v2-c131807e7fe55be721953ee04902f1b8"/></figure><p data-pid="GyC7NgcJ">由于我们刚才创建的主页没有超链接，所以显示完内容立刻就会退出了，因为Line Mode Browser只能支持HTTP/1.0，目前在互联网上的大多数服务器都至少要求HTTP/1.1，因此无法访问许多网站，体验它最好的办法是在现代电脑上搭建一台HTTP/0.9服务器：<a href="https://github.com/remy/old-servers" class=" wrap external" target="_blank" rel="nofollow noreferrer">GitHub - remy/old-servers: Replicate old HTTP server functionality</a></p><p data-pid="FCf6ABAZ">之后就可以用 www &lt;运行old-server的机器地址&gt; 通过LineMode Browser访问了</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-9a275e6b8f49612a3676f71c5dca51c1_b.jpg" data-size="normal" data-rawwidth="885" data-rawheight="541" class="origin_image zh-lightbox-thumb" width="885" data-original="https://pic2.zhimg.com/v2-9a275e6b8f49612a3676f71c5dca51c1_r.jpg" data-original-token="v2-9a275e6b8f49612a3676f71c5dca51c1"/><figcaption>这是世界上第一个网页在许多Unix设备上被访问的样子</figcaption></figure><h2>编译并运行NCSA HTTPd</h2><p data-pid="13Ri6pvG">NCSA HTTPd的早期版本目前已经不太容易找到，幸运的是在Slackware 2.1的源代码目录中，我们可以找到NCSA HTTPd 1.3的源代码，时间为1994年5月7日，略晚于高能所开通WWW服务的时间几个星期，但并不影响其反应当时WWW技术的发展情况</p><p data-pid="TuTt5kVF"><a href="https://mirrors.slackware.com/slackware/slackware-2.1/source/contrib/httpd/" class=" wrap external" target="_blank" rel="nofollow noreferrer">Index of /slackware/slackware-2.1/source/contrib/httpd</a></p><p data-pid="qhKG1uRy">我们将httpd_source.tar.gz上传到SLS，解压后会得到httpd_1.3目录，内容是这样</p><div class="highlight"><pre><code class="language-text">README    cgi-bin/  cgi-src/  conf/     icons/    logs/     src/      support/</code></pre></div><p data-pid="PISeS7px">其中与编译有关的只有src文件夹，我们需要略微修改Make文件，让它能够在Linux下编译</p><div class="highlight"><pre><code class="language-bash"><span class="c1">#进入src文件夹</span>
<span class="nb">cd</span> httpd_1.3/src
<span class="c1">#修改Makefile</span>
vi Makefile</code></pre></div><p data-pid="7oTWSq14">找到下面的代码，我们看到这里有一系列针对不同系统的编译标志，默认的平台是SunOS 4，我们要改成Linux，把AUX_CFLAGS= -DSUNOS4一行前面加上“#”让其失效，然后把AUX_CFLAGS= -DLINUX一行前面的#删去即可</p><div class="highlight"><pre><code class="language-text"># For SunOS 4
AUX_CFLAGS= -DSUNOS4
# For Solaris 2. NOTE: Lots of problems have been identified with compiling
# httpd under Solaris. Use with caution. If you see aberrant behavior with
# httpd under Solaris 2, please mail us.
#AUX_CFLAGS= -DSOLARIS2
#EXTRA_LIBS= -lsocket -lnsl
# For SGI IRIX. Use the EXTRA_LIBS line if you&#39;re using NIS and want
# user-supported directories
#AUX_CFLAGS= -DIRIX
#EXTRA_LIBS= -lsun
# For HP-UX
#AUX_CFLAGS= -DHPUX
# For AIX
#AUX_CFLAGS= -DAIX -U__STR__
# For Ultrix
#AUX_CFLAGS= -DULTRIX
# For DEC OSF/1
#AUX_CFLAGS= -DOSF1
# For NeXT
#AUX_CFLAGS= -DNEXT
# For Sequent
#AUX_CFLAGS= -DSEQUENT
# For Linux -m486 ONLY IF YOU HAVE 486 BINARY SUPPORT IN KERNEL
#AUX_CFLAGS= -DLINUX</code></pre></div><p data-pid="9EqmsYP1">之后使用make命令开始编译，完成后就会得到httpd可执行文件。然后进入httpd_1.3/support目录，再make编译几个支持文件，编译就完成了</p><div class="highlight"><pre><code class="language-bash"><span class="nb">cd</span> ../support
make</code></pre></div><h3>创建NCSA HTTPd工作目录</h3><p data-pid="tuCKKY6I">NCSA HTTPd的默认工作目录是/usr/local/etc/httpd，但在SLS里却默认没有/usr/local目录，而是在跟目录下直接添加了/userlocal目录，按照SLS开发者的说法，是为了额外的灵活性</p><blockquote data-pid="fUBXWYc0">For added flexibility, /usr/local has been left empty, so that locally<br/>installed packages can be maintained separately from the SLS distribution.<br/>为了增加灵活性，/usr/local 留空，以便本地安装的软件包可以与 SLS 发行版分开维护。</blockquote><p data-pid="BOJxMnCs">我们可以创建整个文件夹结构，然后把整个httpd_1.3目录复制过去</p><div class="highlight"><pre><code class="language-bash">mkdir -p /usr/local/etc/httpd
cp -r /root/httpd_1.3/* /usr/local/etc/httpd/</code></pre></div><p data-pid="uvigGqOu">虽然NCSA HTTPd支持使用-d参数自定义配置目录，-f参数自定义配置文件，但可通过命令行控制的也就仅限于这两项了，创建配置目录的话可以减少后续的工作。</p><p data-pid="2S_I3E2b">关于NCSA HTTPd的完整文档，可参考 <a href="https://www6.uniovi.es/~antonio/ncsa_httpd/Overview.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">NCSA httpd Overview</a> ，链接提供的是1.4版，和1.3版的配置文件基本相同。</p><h3>编辑NCSA HTTPd配置文件</h3><p data-pid="Rn-YVtuj">NCSA HTTPd的配置文件默认在 /usr/local/etc/httpd/conf里，有access.conf-dist、httpd.conf-dist和srm.conf-dist三个配置模板文件，我们先复制它们，创建对应的三个配置文件，然后进行小改动即可。</p><p data-pid="M1KHfnal">此外，NCSA HTTPd需要一个额外的用户来运行，我们新建一个名为“www”的用户</p><div class="highlight"><pre><code class="language-bash"><span class="nb">cd</span> /usr/local/etc/httpd/conf
cp httpd.conf-dist httpd.conf
cp srm.conf-dist srm.conf
cp access.conf-dist access.conf
<span class="c1">#创建www用户</span>
useradd www</code></pre></div><p data-pid="tDRk2WLK">修改httpd.conf</p><ul><li data-pid="CYs-M4nj">将User的配置从nobody改为www</li><li data-pid="4asbcAbr">将ServerName改为SLS机器的主机名</li></ul><p data-pid="eZXUewKp">修改srm.conf，让它使用我们刚才为CERN HTTPd创建的主页。</p><ul><li data-pid="4v3wP9pU">将DocumentRoot的配置改为/root/myhttphome</li><li data-pid="_Za_CvYY">将DitectoryIndex改为welcome.html</li></ul><p data-pid="7nOndeYE">然后我们就运行刚才编译的httpd文件，应该在/usr/local/etc/httpd/src里</p><div class="highlight"><pre><code class="language-bash"><span class="nb">cd</span> /usr/local/etc/httpd/src
httpd</code></pre></div><p data-pid="w2ME3nv_">NCSA HTTPd就可以启动了。</p><h2>编译并运行Gopher</h2><p data-pid="o1pQzLsO">在互联网档案馆里，可以找到一系列旧版的Gopher服务器和客户端源码 <a href="https://archive.org/details/OldGopherSources" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">archive.org/details/Old</span><span class="invisible">GopherSources</span><span class="ellipsis"></span></a></p><p data-pid="KyWwwLIz">我们以gopher2.012.tar.Z版本为基础编译和配置，这个版本的代码完成于1994年3月，接近高能所服务器设立的时间。我们用tar zxvf命令将其解压，就可以得到gopher2.012目录，但是目前的压缩包里包含了一些已经编译的文件和修改过的配置，我们需要将其还原之后再编译。</p><div class="highlight"><pre><code class="language-bash"><span class="nb">cd</span> gopher2.012
<span class="c1">#使用原始的Makefile.config替换修改过的版本</span>
cp Makefile.config.org Makefile.config
<span class="c1">#清理已编译的文档</span>
make clean
<span class="c1">#编译gopher</span>
make</code></pre></div><p data-pid="xVT0hkeD">然后我们需要创建/usr/local/etc/gopherd.conf作为配置文件，其中只有一行：hostalias: 192.168.1.29 对应主机的IP地址</p><div class="highlight"><pre><code class="language-bash"> <span class="nb">echo</span> <span class="s2">&#34;hostalias: 192.168.1.29&#34;</span> &gt; /usr/local/etc/gopherd.conf</code></pre></div><p data-pid="Idab4Wh1">接下来我们就还需要创建Gopher服务目录，我们在/root 下创建gopher-data目录，然后创建两个子目录hello和world，然后分别创建两个纯文本文件story1和story2，这样形成一个基本的Gopher目录结构。</p><div class="highlight"><pre><code class="language-bash"><span class="c1">#创建Gopher根目录</span>
mkdir /root/gopher-data
<span class="nb">cd</span> /root/gopher-data
<span class="c1">#创建两个Gopher类目</span>
mkdir hello
mkdir world
<span class="c1">#创建两个文本文件</span>
<span class="nb">echo</span> <span class="s2">&#34;this is story1&#34;</span> &gt; hello/story1
<span class="nb">echo</span> <span class="s2">&#34;this is story2&#34;</span> &gt; world/story2</code></pre></div><p data-pid="meYCBKnG">然后一个基础的Gopher目录就准备好了，我们回到刚才编译的gopher2.012目录中，其中的内容大概如下</p><div class="highlight"><pre><code class="language-text">p:softland:~/gopher2.012$ ls
Copyright             README                gophfilt/
MANIFEST              conf.h                make.com
Makefile              conf.h.org            object/
Makefile.config       doc/                  patchlevel.h
Makefile.config.dist  gopher/               test/
Makefile.config.org   gopherd/</code></pre></div><p data-pid="Q_iCBsuB">gopher/目录包含Gopher客户端，而gopherd/则是服务器，我们先将服务器启动起来，gopherd命令的格式为gopherd &lt;目录&gt; &lt;端口&gt;</p><div class="highlight"><pre><code class="language-bash"><span class="nb">cd</span> gopherd
gopherd /root/gopher-data <span class="m">70</span></code></pre></div><p data-pid="h782tuky">这样我们就将Gopher服务器运行起来了，然后就可以运行Gopher客户端来查看本机的服务器了</p><div class="highlight"><pre><code class="language-bash"><span class="nb">cd</span> ..
<span class="nb">cd</span> gopher
gopher 127.0.0.1</code></pre></div><p data-pid="fJjCed4a">然后就可以浏览我们刚才创建的Gopher目录了</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-60080b99d63b6181ef7a4cc59e0e746b_b.jpg" data-caption="" data-size="normal" data-rawwidth="835" data-rawheight="561" class="origin_image zh-lightbox-thumb" width="835" data-original="https://pic4.zhimg.com/v2-60080b99d63b6181ef7a4cc59e0e746b_r.jpg" data-original-token="v2-60080b99d63b6181ef7a4cc59e0e746b"/></figure><p data-pid="jolzqdM_">值得一提的是，在过去30年里Gopher协议的变化要比WWW少得多，因此我们刚刚编译完成的Gopher客户端也可以访问像<a href="http://gopher.floodgap.com" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">gopher.floodgap.com</span><span class="invisible"></span></a>和<a href="http://sdf.org" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">http://</span><span class="visible">sdf.org</span><span class="invisible"></span></a>这样仍在活跃的Gopher站点。</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-148b40eb06c5774758336113aa584281_b.jpg" data-caption="" data-size="normal" data-rawwidth="835" data-rawheight="561" class="origin_image zh-lightbox-thumb" width="835" data-original="https://pic2.zhimg.com/v2-148b40eb06c5774758336113aa584281_r.jpg" data-original-token="v2-148b40eb06c5774758336113aa584281"/></figure><p data-pid="cANsmgsE">关于Windows telnet的小提示：当使用某些终端仿真程序，比如Windows版本的Telnet连接Linux时，这个版本的Gopher客户端会报错“I don&#39;t understand your terminal type”，此时需要手动设置TERM环境变量，如 export TERM=vt100，之后就可以正常使用了。</p><h2>下集预告</h2><p data-pid="DKxI5Vc6">这一集里我们配置完成了WWW服务器和Gopher服务器，并且也有机会以几乎是最原始的方式提供并访问这两种最重要的Internet信息服务。至此，我们“搭一台1994年的Linux服务器”的目标也基本完成了。这个系列的最后一集，将聚焦于略微超出服务器功能范围，但对于爱好者来说同样重要的部分：配置X-Window环境，运行图形化的Mosaic浏览器，以及让它在最近热门的复古硬件：Pocket 386上运行起来。</p></body></html>